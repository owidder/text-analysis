NullPointerException during XLS import when user has limited permissions	"Reproduction:
# Log in as the default user *joe*. It has read permission on all BBTs except Business Domain. It has write (CUD) permissions for a couple of BBTs.
# Import the attached Excel file. It contains an export of the bank data, but sheets relating to business domains have been removed.
# Assuming you have the bank data loaded, you should safely progress to the step where metamodel changes have been applied.

Effect:
* The dry-run step where changes are applied to the model fails with a general error message.
* internally, the following null pointer exception occurred: {code}
Caused by: java.lang.NullPointerException
        at de.iteratec.iteraplan.elasticeam.derived.AbstractInstanceStore.map(AbstractInstanceStore.java:100)
        at de.iteratec.iteraplan.elasticeam.derived.AbstractInstanceStore.getValue(AbstractInstanceStore.java:220)
        at de.iteratec.iteraplan.elasticeam.derived.QueryableModel.getValue(QueryableModel.java:147)
        at de.iteratec.iteraplan.elasticeam.model.AModelElement.getConnected(AModelElement.java:97)
        at de.iteratec.iteraplan.businesslogic.exchange.elasticeam.validator.IteraplanModelValidator.checkBusinessMappingRelations(IteraplanModelValidator.java:89)
        at de.iteratec.iteraplan.businesslogic.exchange.elasticeam.validator.IteraplanModelValidator.validateBusinessMappings(IteraplanModelValidator.java:83)
        at de.iteratec.iteraplan.businesslogic.exchange.elasticeam.validator.IteraplanModelValidator.validate(IteraplanModelValidator.java:76)
        at de.iteratec.iteraplan.businesslogic.exchange.common.ImportProcess.validateModel(ImportProcess.java:354)
        at de.iteratec.iteraplan.businesslogic.exchange.common.ImportProcess.dryRun(ImportProcess.java:244)
        at de.iteratec.iteraplan.businesslogic.exchange.excel2.excelimport.ImportServiceImpl.modelDryrun(ImportServiceImpl.java:84)
{code}
* This happens because the ModelValidator does not get the informationSystem relation end at the business mapping type, but null"		Bug	iteraplan PO	17/Jul/12 4:25 PM	09/Aug/12 1:41 PM					elasticeam	excel	permissions							"17/Jul/12 4:28 PM;sry;As a sidenote: Uploading that same file into the current developer version (v4.0.SNAPSHOT-r16968 (2012-07-17-15-24-37)) fails immediately. The error page shows no reason, the log file contains: {code}
Caused by: java.lang.IllegalArgumentException: value already present: {org.eclipse.emf.ecore.impl.EClassImpl@4a905bbb (name: InformationSystem) (instanceClassName: null) (abstract: false, interface: false)=runtimePeriod:PropertyExpression}
        at com.google.common.base.Preconditions.checkArgument(Preconditions.java:115)
        at com.google.common.collect.AbstractBiMap.putInBothMaps(AbstractBiMap.java:112)
        at com.google.common.collect.AbstractBiMap.put(AbstractBiMap.java:96)
        at com.google.common.collect.HashBiMap.put(HashBiMap.java:85)
        at de.iteratec.iteraplan.elasticeam.emfimpl.EMFMetamodel.createPropertyImpl(EMFMetamodel.java:1331)
        at de.iteratec.iteraplan.elasticeam.emfimpl.EMFMetamodel.createProperty(EMFMetamodel.java:559)
        at de.iteratec.iteraplan.elasticeam.emfimpl.EMFMetamodel.createProperty(EMFMetamodel.java:534)
        at de.iteratec.iteraplan.io.xls.excel.importer.AbstractSheetImporter.importFeature(AbstractSheetImporter.java:104)
        at de.iteratec.iteraplan.io.xls.excel.importer.UniversaltypeSheetImporter.importMetamodelTypeSpecification(UniversaltypeSheetImporter.java:91)
        at de.iteratec.iteraplan.io.xls.excel.importer.ExcelImporter.importMetamodelFeatures(ExcelImporter.java:355)
        at de.iteratec.iteraplan.io.xls.excel.importer.ExcelImporter.importMetamodel(ExcelImporter.java:178)
        at de.iteratec.iteraplan.io.xls.excel.importer.ExcelImporter.importExcel(ExcelImporter.java:137)
        at de.iteratec.iteraplan.businesslogic.exchange.excel2.excelimport.ExcelImportProcess.importAndCheckFile(ExcelImportProcess.java:69)
        at de.iteratec.iteraplan.businesslogic.exchange.excel2.excelimport.ImportServiceImpl.doImport(ImportServiceImpl.java:65)
{code}

@product manager: Is that considered a problem?"	17/Jul/12 5:15 PM;sry;That NullPointerException also bites you if you export an import template with that restricted user and just add one or two elements. In that case I would assume that the metamodel is 100% clean (because of restricted export), but import fails nevertheless.	"18/Jul/12 10:16 AM;sfe;The mentioned NullPointerException ultimately should be fixed by letting the ModelValidator bypass permission checks to validate the whole model regardless of permissions.
Another method, preferred by csh, would be to make only those instances of the model visible, which are valid under the current permissions. Meaning elements which would become invalid due to missing read permissions shouldn't be visible, thus wouldn't be validated."	"09/Aug/12 10:52 AM;sry;is it really ok that the check for a metamodel being a template was removed from ElasticUtil#createEditableModel in [changeset 17031|https://iteraplan.iteratec.de/projects/iteraplan/changeset/17031]?

Other than that, ok from my point of view. Valentin, for you too?"	09/Aug/12 1:41 PM;kvo;works in 3.0.3 fine	09/Aug/12 3:17 PM;sfe;The removal of said check was done on request by csh.																																																	
