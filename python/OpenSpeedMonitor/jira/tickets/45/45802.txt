Excel-Import: Sequence of POS-Column has gaps after import of new hierarchical elements	"If you import an Excel-File with newly defined hierarchical elements (e.g. AD) that have a parent/child-relationship the sequence in the POS-Column can have gaps.

Consider the following BB to be created during the import:

Name                 Parent      Full parent name
my_parent                        my_parent
i_am_child           my_parent   my_parent : i_am_child

After the import the sequence in the POS-column has a gap.

This is due to the fact that the child is created first (with a sequence number related to the virtual root element), then the parent and after that, the relationship is established (giving the child the sequence number 0).


Workarounds:
If you swap the two lines so that the parent is created first, there will be no gap.

If one of the BB already exists in the Model, there will be no gap either. So you could create the elements with two imports.

Note: The bug had no effect in versions prior to 3.1-RC1, since the import of newly defined hierarchical elements was not possible (due to another bug)."		Bug	iteraplan PO	27/Jun/13 9:22 AM	18/Jul/13 3:20 PM					excel	import								04/Jul/13 11:37 AM;sry;Changing to critical, as it corrupts data.	"08/Jul/13 11:18 AM;jme@iteratec.de;During the creation of a new BB by the factory, the virtuel root element is set as parent.

During the addRelationships method the parent of an element may be adjusted.

Now the element is child of the virtual root element as well as child of the new parent.
This is the reason for the gaps in the POS-column. As hibernate respects the one-to-many-relationship the element is only displayed once."	"08/Jul/13 11:28 AM;jme@iteratec.de;The fix for this problem is to remove the new BB from the children of the virtual root element after setting the new parent.

Unfortunately this leads to another problem, that is even harder to trace.

If there is the following sequence of newly created BB:

... TopLevelElement_A (NotTopLevelElement)(1..n) ChildOfElement_A ...

then the BB ChildOfElement_A has NULL as parent and NULL in the POS-column.

It may be related to some hibernate-magic."	"08/Jul/13 11:30 AM;jme@iteratec.de;A quick fix for the second problem is to sort the changesets by hierachical level.
If you start with the deepest level the described problem can be avoided.

Nevertheless: the problem has to be understood!"	18/Jul/13 3:20 PM;lba;Tested with a new set of data, the pos-column is correctly adjusted and has no gaps.	18/Jul/13 11:33 PM;sry;Thx, this was a very important fix!																																																	
