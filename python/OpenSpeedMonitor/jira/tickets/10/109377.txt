Fehler bei Import einer unveränderten Excel-Datei	"Hallo Herr Stangl,



beim Testen mit iteraplan 5.4 bin ich auf folgendes Problem gestoßen:



Ich exportiere das gesamte Modell als Excel-Datei und versuche anschließend, dieselbe Datei unverändert zu importieren (additiv; Metamodelländerungen übernehmen nicht ausgewählt). Dabei bekomme ich einen Fehler beim Einlsen bzw. bei der Plausibilitätsprüfung. Im Logfile ist eine NullPointerException zu finden.



Vielen Dank vorab für Ihre Unterstützung.



Beste Grüße

Matthias Habermann"		Fault	iteraplan Support	23/Jan/17 5:25 PM	24/Jan/17 3:52 PM														"23/Jan/17 5:25 PM;matthias.habermann@wacker.com;

!Fehler_Excel_Import.PNG|thumbnail!

[^iteraplan-5.4.0_fehler_excel_import.log] _(24 kB)_"	"24/Jan/17 9:48 AM;cst;Guten Morgen Herr Habbermann, 

vielen Dank für Ihre Antwort.

Ist es möglich das Sie uns die zu importierende Excel-Datei zukommen lassen, um hier den Vorgang weiter prüfen zu können.

Viele Grüße,

Christoph Stangl - iteraplan Support

"	"24/Jan/17 10:35 AM;matthias.habermann@wacker.com;Hallo Herr Stangl,

die gesamte Excel-Datei werde ich Ihnen leider nicht zur Verfügung stellen dürfen. Ich werde versuchen das Problem einzugrenzen, z.B. zunächst auf den betroffenen Bebauungselementtyp. Evtl. lassen sich dann verdächtige Datumswerte (danach sieht es meiner Meinung nach aus) identifizieren. Sie bekommen dann ein Update von mir.

Viele Grüße
Matthias Habermann"	"24/Jan/17 2:02 PM;matthias.habermann@wacker.com;Hallo Herr Stangl,

ich habe die Ursache gefunden: Der Wert eines Datumsmerkmals eines Technischen Bausteins enthielt den Wert 31.12.1014 (vermutlich war das Jahr 2014 gemeint). Im Excel-Export war dafür der Wert -1 enthalten, und damit kommt die Apache POI Library nicht zurecht. getJavaCalendar() liefert für Werte <= 0 null zurück und damit tritt in getJavaDate() die NullPointerException auf (siehe Screenshots).

Ich habe das Datum korrigiert und jetzt klappt der Import.

Das scheint laut Schulungsunterlagen eine bekannte Beschränkung des Excel-Exports zu sein: ""Die Daten für Laufzeiträume müssen gültige Excel-Datumswerte sein. Gültige Datumswerte sind alle Daten nach dem 1. Januar 1900.""

Ist natürlich etwas unschön, dass dafür nicht an irgendeiner Stelle eine Validierung mit entsprechender Meldung existiert - entweder direkt bei der Eingabe, beim Export oder spätestens beim Import.

Viele Grüße
Matthias Habermann

!Datum_iteraplan.PNG|thumbnail!

!Datum_Excel.PNG|thumbnail!

!getJavaDate.PNG|thumbnail!"	"24/Jan/17 3:52 PM;cst;Vielen Dank für die ausführliche Antwort. 



Habe diese an unser Entwicklerteam weiter gegeben, um in einer der zukünftigen Releases hier eine Prüfung einzubauen. 



Grüße,



Christoph Stangl - iteraplan Support"																																																		
