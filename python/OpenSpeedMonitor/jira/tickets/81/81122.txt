[Integrationstests] Funktionieren nicht mit Spock-where-Block	"Zu Beispiel hier: WeeklyShopMultipleCsiGroupsIntTests

{code}

Exception in thread ""main"" java.lang.VerifyError: (class: de/iteratec/osm/csi/WeeklyShopMultipleCsiGroupsIntTests, method: $tt__$spock_feature_1_0 signature: (Ljava/lang/Object;Ljava/lang/Object;Lorg/springframework/transaction/TransactionStatus;)V) Incompatible argument to function

    at java.lang.Class.getDeclaredFields0(Native Method)

    at java.lang.Class.privateGetDeclaredFields(Class.java:2499)

    at java.lang.Class.getDeclaredFields(Class.java:1811)

    at org.spockframework.runtime.SpecInfoBuilder.buildFields(SpecInfoBuilder.java:98)

    at org.spockframework.runtime.SpecInfoBuilder.doBuild(SpecInfoBuilder.java:69)

    at org.spockframework.runtime.SpecInfoBuilder.build(SpecInfoBuilder.java:54)

    at org.spockframework.runtime.Sputnik.getSpec(Sputnik.java:80)

    at org.spockframework.runtime.Sputnik.runExtensionsIfNecessary(Sputnik.java:88)

    at org.spockframework.runtime.Sputnik.getDescription(Sputnik.java:55)

    at com.intellij.junit4.JUnit4IdeaTestRunner.getDescription(JUnit4IdeaTestRunner.java:123)

    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:99)

    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)

    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)

    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)

    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)

    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

    at java.lang.reflect.Method.invoke(Method.java:606)

    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)

{code}"		Task	OpenSpeedMonitor	20/Apr/16 11:15 AM	25/Apr/16 12:27 PM														"25/Apr/16 11:50 AM;msk;

Problem, dass der where: Block überhaupt nicht funktioniert, beruht auf einem Bug in Grails 3.1.4 und wurde in Grails 3.1.5 behoben. Daher sollten wir evtl auf Grails 3.1.5 upgraden (https://github.com/grails/grails-core/issues/9837)



Wir benutzen allerdings manchmal eine spezielle schreibweise des where: Blocks

{code:java}

where:

   variableUsedInTest << dataToUseInTest

{code}

dieses Konstrukt funktioniert nicht mehr, da dataToUseInTest im setupSpec() initialisiert werden muss (setup() ist zu spät). Da wir im setupSpec() keine Spring-Unterstützung mehr haben (JPA, Injections), können die Daten nicht initialisiert werden und es gibt einen Compiler-Error:

{code:java}

org.spockframework.runtime.SpockExecutionException: Data provider is null

{code}

"																																																						
