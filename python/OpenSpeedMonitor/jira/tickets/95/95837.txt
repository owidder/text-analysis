Invoke of role in Roles and Permissions not possible	If I try to select and open a role I got a general technical error (see attached problem report)		Fault	iteraplan Support	12/Sep/16 2:47 PM	20/Sep/16 8:29 AM														"12/Sep/16 2:47 PM;thomas.liskow@coface.com;

[^ProblemReport_2016-09-12_144216.zip] _(9 kB)_"	12/Sep/16 3:36 PM;thomas.liskow@coface.com;I selected the wrong release. It works with our UAT system V. 5.3 but the PROD system v 5.2 has the problem	"12/Sep/16 3:56 PM;cst;Hello Mr. Liskow, 

can you please check your database for the table ""DATASOURCE"".
When this table is missing, the database is on version 5.2, but when you finding the table ""DATASOURCE"", the update script from version 5.1 to 5.2 was not executed. 

Greetings,

Christoph Stangl - iteraplan Support "	"16/Sep/16 8:11 AM;thomas.liskow@coface.com;Hello Mr. Stangl,

we checked it. The script was executed and the mentioned table exists.

Kind regards,

Thomas Liskow"	"16/Sep/16 8:31 AM;cst;Hallo Mr. Liskwo,

when the script from 5.1 to 5.2 is executed, the table ""DATASOURCE"" is going to be deleted.
We updated/deleted tables in iteraplan 5.2 for the ROLE managment and this can be the reason for your problem.

Would you please send us the following LOG-Files so we can check the problem.

From the conf-directory of your Tomcat-Installation:
server.xml
web.xml

The “catalina.out”, “localhost.log” and ""localhost_access_log.[TIMESTAMP].txt"" the files from 
your tomcat installation (just for the period, when the error occurred). 

From [Tomcat]/webapps/[iteraplan directory]/WEB-INF/classes:
log4j.properties

From [Tomcat]/webapps/[iteraplan directory]/META-INF:
context.xml (This file can contain passwords -> please remove the passwords)*

The iteraplan log files from the period, when the error occurred. 
The files are called “iteraplan-[version].log” (for today) or „iteraplan-[version].log.[TIMESTAMP]” (for past days). 

The location of these file was specified during installation and is documented in the file “log4j.properties”.

Greetings, 

Christoph Stangl - iteraplan Support"	"16/Sep/16 10:18 AM;thomas.liskow@coface.com;Hello Mr. Stangl,

attached the requested information

We upgraded this morning to iteraplan 5.3. So you will see some errors before 9:30 which belong to this upgrade.

The mentioned error with invoke of role in the view ""Roles and Permissions"" occurs on 9:44 and 9:54.

Kind regards,

Thomas LIskow

[^iteraplan-PROD-log-16.09.2016.zip] _(76 kB)_"	"16/Sep/16 10:42 AM;cst;Dear Mr. Liskow , 

I checked with our developers the log files and the result is a problem in the database. 
Would you please send us a screenshot from following SQL statement: 

select * from perm_functional;

In this table could be a false entry the reason for your error. 

Greetings,

Christoph Stangl - iteraplan Support "	"19/Sep/16 8:09 AM;thomas.liskow@coface.com;Attached the data from the mentioned sql statement

Kind regards,
T. Liskow

[^perm_functional.txt] _(4 kB)_"	"19/Sep/16 8:37 AM;cst;Dear Mr. Liskow.



The problem is, that the update script from version 5.1 to 5.2 was not executed.

In the table ""perm_functional"" is still the entry ""role.permission.ChangeDataSource"". 



The passage in the script is marked:



""SET SQL_SAFE_UPDATES=0;



RENAME TABLE `AT` TO `ATTR`;

RENAME TABLE `HIST_AT` TO `HIST_ATTR`;



ALTER TABLE `USERS` DROP COLUMN `DATASOURCE`;

DROP TABLE `DATASOURCE`;



*DELETE FROM `ROLE_FUNCTIONAL` WHERE `ID_FP`=(SELECT `ID` FROM `PERM_FUNCTIONAL` WHERE `TYPE`='role.permission.ChangeDataSource');*

DELETE FROM `PERM_FUNCTIONAL` WHERE `TYPE` = 'role.permission.ChangeDataSource';



SET SQL_SAFE_UPDATES=1;



COMMIT;""



Would you please executing the script to solve the problem. 



[^v5.1To5.2.zip]



Greetings,



Christoph Stangl - iteraplan Support 



"	"19/Sep/16 4:16 PM;thomas.liskow@coface.com;We could fix the problem now by deleting the entry from table ""perm_functional"". Our admin told me that the script wasn't executed completely during the upgrade because of a syntax/script problem which skipped the delete statement.

Please close the incident

Kind regards,
Thomas Liskow"																																													
